package;

import delaunay.Set;
import delaunay.Triangulate;
import delaunay.DhxPoint;
import delaunay.RealPoint;
import delaunay.Edge;
import massive.munit.Assert;
import haxe.PosInfos;

class LargeDataTest {

    private function p ( x: Float, y: Float ): RealPoint {
        return new RealPoint(x, y);
    }

    private function e (
        x1: Float, y1: Float,
        x2: Float, y2: Float
    ): Edge<RealPoint> {
        return new Edge( p(x1, y1), p(x2, y2) );
    }

    private function es ( from: RealPoint, to: Array<RealPoint> ) {
        return Lambda.array( Lambda.map(to, function (point) {
            return new Edge(from, point);
        }) );
    }

    private function tri (
        x1: Float, y1: Float,
        x2: Float, y2: Float,
        x3: Float, y3: Float
    ) {
        return [ e(x1, y1, x2, y2), e(x2, y2, x3, y3), e(x3, y3, x1, y1) ];
    }

    @Test public function test15Points() {
        // These points were taken from here:
        // http://www.mathworks.com/help/matlab/math/voronoi-diagrams.html

        var x1 = p(-1.5, 3.2);
        var x2 = p(1.8, 3.3);
        var x3 = p(-3.7, 1.5);
        var x4 = p(-1.5, 1.3);
        var x5 = p(0.8, 1.2);
        var x6 = p(3.3, 1.5);
        var x7 = p(-4.0, -1.0);
        var x8 = p(-2.3, -0.7);
        var x9 = p(0, -0.5);
        var x10 = p(2.0, -1.5);
        var x11 = p(3.7, -0.8);
        var x12 = p(-3.5, -2.9);
        var x13 = p(-0.9, -3.9);
        var x14 = p(2.0, -3.5);
        var x15 = p(3.5, -2.25);

        Helper.assertEdges(Helper.flatten([
            es(x1, [ x3, x4, x5, x2 ]),
            es(x2, [ x1, x5, x6 ]),
            es(x3, [ x7, x8, x4, x1 ]),
            es(x4, [ x1, x5, x9, x8, x3 ]),
            es(x5, [ x2, x6, x10, x9, x4, x1 ]),
            es(x6, [ x11, x10, x5, x2 ]),
            es(x7, [ x3, x8, x12 ]),
            es(x8, [ x4, x9, x13, x12, x7, x3 ]),
            es(x9, [ x5, x10, x13, x8, x4 ]),
            es(x10, [ x6, x11, x15, x14, x13, x9, x5 ]),
            es(x11, [ x15, x10, x6 ]),
            es(x12, [ x8, x13, x7 ]),
            es(x13, [ x9, x10, x14, x12, x8 ]),
            es(x14, [ x10, x15, x13 ]),
            es(x15, [ x11, x14, x10 ])
        ]));
    }

    @Test public function test10Points() {
        // These points were taken from here:
        // http://www.geom.uiuc.edu/locate/user/samuelp/rnd_10.ps

        Helper.assertEdges(Helper.flatten([
            tri(25.621, 183.763, 189.82, 187.408, 34.7438, 169.193),
            tri(34.7438, 169.193, 149.8, 136.398, 78.5315, 105.348),
            tri(34.7438, 169.193, 189.82, 187.408, 149.8, 136.398),
            tri(78.5315, 105.348, 149.8, 136.398, 242.773, 38.4628),
            tri(149.8, 136.398, 248.387, 63.4285, 242.773, 38.4628),
            tri(242.773, 38.4628, 248.387, 63.4285, 295.668, 67.0482),
            tri(25.621, 183.763, 266.461, 393.537, 189.82, 187.408),
            tri(189.82, 187.408, 266.461, 393.537, 319.379, 171.034),
            tri(248.387, 63.4285, 319.379, 171.034, 295.668, 67.0482),
            tri(189.82, 187.408, 319.379, 171.034, 248.387, 63.4285),
            tri(149.8, 136.398, 189.82, 187.408, 248.387, 63.4285)
        ]));
    }

    @Test public function test100Points() {
        // These points were taken from here:
        // http://www.geom.uiuc.edu/locate/user/samuelp/rnd_100.ps

        Helper.assertEdges(Helper.flatten([
            tri(90.3344, 209.023, 108.252, 207.621, 102.282, 203.034),
            tri(85.8642, 225.438, 99.2912, 234.81, 90.3344, 209.023),
            tri(79.8729, 210.498, 85.8642, 225.438, 90.3344, 209.023),
            tri(79.8729, 210.498, 91.8293, 318.057, 85.8642, 225.438),
            tri(85.8642, 225.438, 91.8293, 318.057, 108.252, 300.132),
            tri(91.8293, 318.057, 121.703, 331.48, 108.252, 300.132),
            tri(108.252, 300.132, 121.703, 331.48, 132.167, 297.131),
            tri(121.703, 331.48, 156.057, 334.467, 132.167, 297.131),
            tri(132.167, 297.131, 156.057, 334.467, 171, 283.829),
            tri(156.057, 334.467, 170.982, 352.391, 171, 283.829),
            tri(170.982, 352.391, 244.173, 324.032, 171, 283.829),
            tri(171, 283.829, 244.173, 324.032, 185.958, 262.813),
            tri(185.958, 262.813, 244.173, 324.032, 283.02, 288.173),
            tri(244.173, 324.032, 256.125, 324.016, 283.02, 288.173),
            tri(256.125, 324.016, 305.407, 328.502, 283.02, 288.173),
            tri(283.02, 288.173, 305.407, 328.502, 342.748, 277.728),
            tri(305.407, 328.502, 315.863, 337.524, 342.748, 277.728),
            tri(315.863, 337.524, 322.355, 361.396, 342.748, 277.728),
            tri(322.355, 361.396, 366.647, 237.383, 342.748, 277.728),
            tri(342.748, 277.728, 366.647, 237.383, 344.245, 249.337),
            tri(339.764, 235.889, 344.245, 249.337, 366.647, 237.383),
            tri(339.764, 235.889, 366.647, 237.383, 351.71, 191.092),
            tri(351.71, 191.092, 366.647, 237.383, 353.206, 189.62),
            tri(353.206, 189.62, 366.647, 237.383, 371.127, 102.967),
            tri(353.206, 189.62, 371.127, 102.967, 360.671, 123.927),
            tri(333.798, 104.453, 360.671, 123.927, 371.127, 102.967),
            tri(290.501, 81.0409, 333.798, 104.453, 371.127, 102.967),
            tri(290.501, 81.0409, 299.435, 100.013, 333.798, 104.453),
            tri(299.435, 100.013, 315.867, 111.94, 333.798, 104.453),
            tri(315.867, 111.94, 323.334, 128.358, 333.798, 104.453),
            tri(323.334, 128.358, 339.772, 128.375, 333.798, 104.453),
            tri(333.798, 104.453, 339.772, 128.375, 360.671, 123.927),
            tri(335.296, 143.31, 360.671, 123.927, 339.772, 128.375),
            tri(323.334, 128.358, 335.296, 143.31, 339.772, 128.375),
            tri(303.917, 156.731, 335.296, 143.31, 323.334, 128.358),
            tri(271.056, 126.878, 303.917, 156.731, 323.334, 128.358),
            tri(271.056, 126.878, 323.334, 128.358, 315.867, 111.94),
            tri(271.056, 126.878, 315.867, 111.94, 295.096, 101.488),
            tri(295.096, 101.488, 315.867, 111.94, 299.435, 100.013),
            tri(290.501, 81.0409, 295.096, 101.488, 299.435, 100.013),
            tri(284.5, 79.4724, 295.096, 101.488, 290.501, 81.0409),
            tri(266.574, 108.934, 295.096, 101.488, 284.5, 79.4724),
            tri(90.3344, 209.023, 99.2912, 234.81, 108.252, 207.621),
            tri(159.036, 79.0666, 181.457, 96.9878, 284.5, 79.4724),
            tri(159.036, 79.0666, 162.048, 125.372, 181.457, 96.9878),
            tri(162.048, 125.372, 176.961, 117.899, 181.457, 96.9878),
            tri(176.961, 117.899, 193.388, 111.931, 181.457, 96.9878),
            tri(181.457, 96.9878, 193.388, 111.931, 266.574, 108.934),
            tri(193.388, 111.931, 215.796, 132.831, 266.574, 108.934),
            tri(215.796, 132.831, 271.056, 126.878, 266.574, 108.934),
            tri(266.574, 108.934, 271.056, 126.878, 295.096, 101.488),
            tri(214.299, 140.303, 271.056, 126.878, 215.796, 132.831),
            tri(202.349, 133.003, 214.299, 140.303, 215.796, 132.831),
            tri(193.388, 111.931, 202.349, 133.003, 215.796, 132.831),
            tri(182.978, 125.37, 202.349, 133.003, 193.388, 111.931),
            tri(176.961, 117.899, 182.978, 125.37, 193.388, 111.931),
            tri(162.048, 125.372, 182.978, 125.37, 176.961, 117.899),
            tri(156.062, 135.821, 182.978, 125.37, 162.048, 125.372),
            tri(120.201, 94.0039, 156.062, 135.821, 162.048, 125.372),
            tri(120.201, 94.0039, 162.048, 125.372, 159.036, 79.0666),
            tri(99.2996, 91.0102, 120.201, 94.0039, 159.036, 79.0666),
            tri(99.2996, 91.0102, 106.779, 131.339, 120.201, 94.0039),
            tri(106.779, 131.339, 156.062, 135.821, 120.201, 94.0039),
            tri(106.779, 131.339, 108.258, 134.342, 156.062, 135.821),
            tri(108.258, 134.342, 114.235, 167.184, 156.062, 135.821),
            tri(114.235, 167.184, 154.56, 173.163, 156.062, 135.821),
            tri(154.56, 173.163, 182.978, 125.37, 156.062, 135.821),
            tri(154.56, 173.163, 202.349, 133.003, 182.978, 125.37),
            tri(154.56, 173.163, 214.398, 161.252, 202.349, 133.003),
            tri(202.349, 133.003, 214.398, 161.252, 214.299, 140.303),
            tri(214.299, 140.303, 214.398, 161.252, 271.056, 126.878),
            tri(214.398, 161.252, 223.263, 177.639, 271.056, 126.878),
            tri(223.263, 177.639, 281.558, 168.704, 271.056, 126.878),
            tri(271.056, 126.878, 281.558, 168.704, 303.917, 156.731),
            tri(281.558, 168.704, 300.937, 176.156, 303.917, 156.731),
            tri(300.937, 176.156, 336.828, 176.166, 303.917, 156.731),
            tri(303.917, 156.731, 336.828, 176.166, 335.296, 143.31),
            tri(335.296, 143.31, 336.828, 176.166, 353.206, 189.62),
            tri(336.828, 176.166, 351.71, 191.092, 353.206, 189.62),
            tri(317.409, 209.011, 351.71, 191.092, 336.828, 176.166),
            tri(300.937, 176.156, 317.409, 209.011, 336.828, 176.166),
            tri(287.491, 179.133, 317.409, 209.011, 300.937, 176.156),
            tri(281.558, 168.704, 287.491, 179.133, 300.937, 176.156),
            tri(269.56, 209.061, 287.491, 179.133, 281.558, 168.704),
            tri(247.157, 203.03, 269.56, 209.061, 281.558, 168.704),
            tri(181.457, 96.9878, 266.574, 108.934, 284.5, 79.4724),
            tri(223.263, 177.639, 247.157, 203.03, 281.558, 168.704),
            tri(239.71, 207.531, 266.582, 215.001, 247.157, 203.03),
            tri(247.157, 203.03, 266.582, 215.001, 269.56, 209.061),
            tri(266.582, 215.001, 290.563, 222.447, 269.56, 209.061),
            tri(269.56, 209.061, 290.563, 222.447, 287.491, 179.133),
            tri(287.491, 179.133, 290.563, 222.447, 317.409, 209.011),
            tri(290.563, 222.447, 339.764, 235.889, 317.409, 209.011),
            tri(317.409, 209.011, 339.764, 235.889, 351.71, 191.092),
            tri(290.563, 222.447, 324.834, 259.8, 339.764, 235.889),
            tri(324.834, 259.8, 344.245, 249.337, 339.764, 235.889),
            tri(324.834, 259.8, 342.748, 277.728, 344.245, 249.337),
            tri(283.02, 288.173, 342.748, 277.728, 324.834, 259.8),
            tri(283.02, 288.173, 324.834, 259.8, 290.563, 222.447),
            tri(266.582, 215.001, 283.02, 288.173, 290.563, 222.447),
            tri(239.71, 207.531, 283.02, 288.173, 266.582, 215.001),
            tri(185.958, 262.813, 283.02, 288.173, 239.71, 207.531),
            tri(173.995, 210.505, 185.958, 262.813, 239.71, 207.531),
            tri(173.995, 210.505, 239.71, 207.531, 223.263, 177.639),
            tri(168.001, 191.085, 173.995, 210.505, 223.263, 177.639),
            tri(168.001, 191.085, 223.263, 177.639, 214.398, 161.252),
            tri(154.56, 173.163, 168.001, 191.085, 214.398, 161.252),
            tri(154.56, 173.163, 162.133, 197.056, 168.001, 191.085),
            tri(162.133, 197.056, 173.995, 210.505, 168.001, 191.085),
            tri(162.133, 197.056, 163.55, 213.487, 173.995, 210.505),
            tri(160.543, 229.932, 173.995, 210.505, 163.55, 213.487),
            tri(141.206, 216.478, 160.543, 229.932, 163.55, 213.487),
            tri(141.206, 216.478, 163.55, 213.487, 162.133, 197.056),
            tri(120.22, 188.112, 141.206, 216.478, 162.133, 197.056),
            tri(120.22, 188.112, 162.133, 197.056, 154.56, 173.163),
            tri(117.229, 171.683, 120.22, 188.112, 154.56, 173.163),
            tri(114.235, 167.184, 117.229, 171.683, 154.56, 173.163),
            tri(102.277, 164.204, 117.229, 171.683, 114.235, 167.184),
            tri(102.277, 164.204, 114.235, 167.184, 102.297, 147.767),
            tri(102.297, 147.767, 114.235, 167.184, 108.258, 134.342),
            tri(88.8488, 131.616, 102.297, 147.767, 108.258, 134.342),
            tri(88.8488, 131.616, 108.258, 134.342, 106.779, 131.339),
            tri(88.8488, 131.616, 106.779, 131.339, 90.3665, 96.9864),
            tri(90.3665, 96.9864, 106.779, 131.339, 99.2996, 91.0102),
            tri(81.3834, 98.4878, 90.3665, 96.9864, 99.2996, 91.0102),
            tri(81.3834, 98.4878, 88.8488, 131.616, 90.3665, 96.9864),
            tri(79.8748, 143.286, 88.8488, 131.616, 81.3834, 98.4878),
            tri(79.8748, 143.286, 102.297, 147.767, 88.8488, 131.616),
            tri(79.8748, 143.286, 102.277, 164.204, 102.297, 147.767),
            tri(79.8729, 210.498, 102.277, 164.204, 79.8748, 143.286),
            tri(79.8729, 210.498, 96.3524, 200.051, 102.277, 164.204),
            tri(96.3524, 200.051, 117.229, 171.683, 102.277, 164.204),
            tri(96.3524, 200.051, 120.22, 188.112, 117.229, 171.683),
            tri(96.3524, 200.051, 112.752, 200.045, 120.22, 188.112),
            tri(126.176, 242.082, 160.543, 229.932, 141.206, 216.478),
            tri(126.176, 242.082, 141.112, 273.415, 160.543, 229.932),
            tri(141.112, 273.415, 185.958, 262.813, 160.543, 229.932),
            tri(160.543, 229.932, 185.958, 262.813, 173.995, 210.505),
            tri(141.112, 273.415, 171, 283.829, 185.958, 262.813),
            tri(132.167, 297.131, 171, 283.829, 141.112, 273.415),
            tri(108.252, 300.132, 132.167, 297.131, 141.112, 273.415),
            tri(108.252, 300.132, 141.112, 273.415, 118.718, 249.355),
            tri(118.718, 249.355, 141.112, 273.415, 126.176, 242.082),
            tri(118.718, 249.355, 126.176, 242.082, 120.202, 237.383),
            tri(99.2912, 234.81, 118.718, 249.355, 120.202, 237.383),
            tri(99.2912, 234.81, 108.252, 300.132, 118.718, 249.355),
            tri(85.8642, 225.438, 108.252, 300.132, 99.2912, 234.81),
            tri(335.296, 143.31, 353.206, 189.62, 360.671, 123.927),
            tri(309.89, 371.855, 322.355, 361.396, 314.377, 364.517),
            tri(314.377, 364.517, 322.355, 361.396, 315.863, 337.524),
            tri(286.001, 359.869, 314.377, 364.517, 315.863, 337.524),
            tri(286.001, 359.869, 315.863, 337.524, 305.407, 328.502),
            tri(256.125, 324.016, 286.001, 359.869, 305.407, 328.502),
            tri(244.173, 324.032, 286.001, 359.869, 256.125, 324.016),
            tri(166.512, 371.933, 286.001, 359.869, 244.173, 324.032),
            tri(166.512, 371.933, 244.173, 324.032, 170.982, 352.391),
            tri(156.049, 362.852, 166.512, 371.933, 170.982, 352.391),
            tri(150.096, 340.446, 156.049, 362.852, 170.982, 352.391),
            tri(150.096, 340.446, 170.982, 352.391, 156.057, 334.467),
            tri(121.703, 331.48, 150.096, 340.446, 156.057, 334.467),
            tri(121.703, 331.48, 121.728, 366.073, 150.096, 340.446),
            tri(121.728, 366.073, 148.582, 361.352, 150.096, 340.446),
            tri(148.582, 361.352, 156.049, 362.852, 150.096, 340.446),
            tri(148.582, 361.352, 166.512, 371.933, 156.049, 362.852),
            tri(121.728, 366.073, 166.512, 371.933, 148.582, 361.352),
            tri(87.3424, 355.391, 121.728, 366.073, 99.342, 335.979),
            tri(99.342, 335.979, 121.728, 366.073, 121.703, 331.48),
            tri(91.8293, 318.057, 99.342, 335.979, 121.703, 331.48),
            tri(87.3424, 355.391, 99.342, 335.979, 91.8293, 318.057),
            tri(79.8729, 210.498, 87.3424, 355.391, 91.8293, 318.057),
            tri(166.512, 371.933, 309.89, 371.855, 286.001, 359.869),
            tri(286.001, 359.869, 309.89, 371.855, 314.377, 364.517),
            tri(99.2912, 234.81, 126.181, 217.979, 108.252, 207.621),
            tri(99.2912, 234.81, 120.202, 237.383, 126.181, 217.979),
            tri(120.202, 237.383, 126.176, 242.082, 126.181, 217.979),
            tri(126.176, 242.082, 141.206, 216.478, 126.181, 217.979),
            tri(120.22, 188.112, 126.181, 217.979, 141.206, 216.478),
            tri(112.752, 200.045, 126.181, 217.979, 120.22, 188.112),
            tri(108.252, 207.621, 126.181, 217.979, 112.752, 200.045),
            tri(102.282, 203.034, 108.252, 207.621, 112.752, 200.045),
            tri(96.3524, 200.051, 102.282, 203.034, 112.752, 200.045),
            tri(90.3344, 209.023, 102.282, 203.034, 96.3524, 200.051),
            tri(223.263, 177.639, 239.71, 207.531, 247.157, 203.03),
            tri(79.8729, 210.498, 90.3344, 209.023, 96.3524, 200.051),
        ]));
    }
}

